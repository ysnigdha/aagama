USE EMPDB
SELECT *FROM EMP_TB
SELECT *FROM EMP_TB WHERE ESAL=(SELECT MAX(ESAL)FROM EMP_TB WHERE ESAL<(SELECT MAX(ESAL) FROM EMP_TB)) --SECOND HIGHEST SALARY
SELECT *FROM EMP_TB WHERE ESAL=(SELECT MAX(ESAL)FROM EMP_TB) --HIGHEST SALARY

-- MATHEMATICAL FUNCTIONS
SELECT ABS(10) --ABSOLUTE (POSITIVE)
SELECT ABS(-10)--ABSOLUTE (POSITIVE)

SELECT CEILING (15.6) --16
SELECT FLOOR(15.6) --15

SELECT LOG(10) --2.30258509299405
SELECT LOG10(10) --1
SELECT PI() --3014592
SELECT POWER(10,3) --1000

SELECT ROUND(156.567,2) --156.57
SELECT ROUND(126.567,-1) --130.00
SELECT SQRT(81)  --9
SELECT SQUARE(4) --16
SELECT CHAR(97) --a
SELECT ASCII('A') --65
SELECT CHARINDEX('O','HELLO WORLD')  --5
SELECT LEFT('HELLO', 3) --HEL
SELECT RIGHT('HELLO',3)  --LLO 
--SELECT * FROM EMP WHERE RIGHT(ENAME,2)='TT' // WHOS NAME ENDS WITH CHARACTERS TT
SELECT SUBSTRING('HELLO', 1,3)  --HEL
SELECT SUBSTRING('HELLO', 2,2)  --EL
SELECT LEN('HELLO')  --5
SELECT LEN('   HELLO')  --8
-- SELECT * FROM EMP WHERE LEN(ENAME)=5
SELECT LOWER('Hello')  --hello
SELECT UPPER('hello')  --HELLO

SELECT LEN(LTRIM('   HELLO')) --5   //REMOVES LEADING BLANKS
SELECT 'HELLO '+LTRIM ('WORLD')  --HELLO WORLD
SELECT REPLACE('HELLO','L','X')   --HEXXO
SELECT REPLICATE('HELL',2)   --HELLHELL 
SELECT REVERSE('HELLO')   --OLLEH
SELECT SOUNDEX('Smith'),SOUNDEX('Smyth')   --S530     S530
SELECT 'HELLO'+SPACE(1)+'WORLD'   --HELLO WORLD

--DATE AND TIME FUNCTIONS

SELECT GETDATE()  --2015-12-18 23:29:06.0877
SELECT DAY(GETDATE())  --18 //DATE
SELECT DAY('10/24/1986')  --24
SELECT MONTH(GETDATE()) -- 12 // MONTH DECEMBER
SELECT YEAR(GETDATE())  --2015
SELECT DATENAME(MM,'07/24/1986')  --JULY
SELECT DATEADD(DD,30,GETDATE())  --ADDS 30 DAYS TO GETDATE()

--SET OPERATORS
SELECT COUNT(*) FROM BTECH_TB
SELECT SUM(STSAL) FROM BTECH_TB   --SUM OF ALL THE VALUES
SELECT AVG(STSAL) FROM BTECH_TB   --AVG OF THE VALUES 
SELECT MAX(STSAL) FROM BTECH_TB    
SELECT MIN(STSAL) FROM BTECH_TB
SELECT STDEV(STSAL) FROM BTECH_TB   --STANDARD DEVIATION
SELECT VAR(STSAL) FROM BTECH_TB    -- 50000000   VARIANCE OF ALL VALUES  

-- LOGICAL OPERATORS
SELECT * FROM BTECH_TB WHERE SNAME='MANASA'  --NAME WITH MANASA
SELECT * FROM BTECH_TB WHERE SNAME!='MANASA'  --EXCEPT MANASA REMAINING DATA WILL DISPLAY
--(OR)
SELECT * FROM BTECH_TB WHERE SNAME <> 'MANASA'

SELECT * FROM BTECH_TB WHERE STSAL>=5000 AND STSAL<=15000
-- OR
SELECT * FROM BTECH_TB WHERE STSAL BETWEEN 5000 AND 15000  --RANGE BETWEEN 5000 AND  15000

SELECT * FROM BTECH_TB WHERE STSAL NOT BETWEEN 5000 AND 15000  -- LESS THAN 5000 ND 15000
SELECT * FROM BTECH_TB WHERE SNAME IN('MANASA','SRUTHI')  -- RETURNS MANASA AND SRUTHI
SELECT * FROM EMP WHERE JOB='CLERK' OR JOB='MANAGER' OR JOB='SALESMAN'
SELECT * FROM EMP WHERE JOB='CLERK' OR SAL>30000

SELECT * FROM BTECH_TB WHERE SNAME LIKE 'S%'  --RETURNS NAME START WITH 'S'
SELECT * FROM BTECH_TB WHERE SNAME LIKE '%M%'  --RETURNS WHOSE NAME CONTAINS 'M' IN IT
SELECT * FROM BTECH_TB WHERE SNAME LIKE 'SM_TH'  --RETURNS SPELLING NOT KNOWN // SMITH OR SMYTH
-- OR
SELECT * FROM BTECH_TB WHERE SOUNDEX(SNAME)=SOUNDEX('SMYTH')

SELECT * FROM BTECH_TB WHERE SNAME LIKE'[A-S]%'  --RETURNS WHOSE NAME STARTS WITH A CHARACTER BETWEEN A TO S
SELECT * FROM BTECH_TB WHERE SNAME LIKE'[ABCEDSFSFM]%'  --RETURNS NAME STARTS WITH ANY OF THE CHARACTERS ABCEDSFSFM
SELECT * FROM BTECH_TB WHERE SNAME LIKE '[^A-S]%'  -- RETURNS NAME STARTS CHARACTER NOT BETWEEN A TO S


--GROUP BY CLAUSES
SELECT SNAME,MAX(STSAL) FROM BTECH_TB GROUP BY SNAME
SELECT SNAME, COUNT(*) FROM BTECH_TB GROUP BY SNAME   -- NUMBER OF PERSONS WORKING IN EACH FROM TABLE

--FOREIGN KEY
ALTER TABLE CSE_TB ADD CONSTRAINT FK_CSE_STUDID FOREIGN KEY(STUDID) REFERENCES BTECH_TB(STID)


